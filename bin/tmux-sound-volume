#!/bin/zsh

if [[ $OSTYPE == darwin* ]]; then
  local sound_info=$(osascript -e 'get volume settings')
  local sound
  if  [[ -n $sound_info ]] && [[ "$(echo $sound_info| awk '{print $8}')" = "muted:false" ]]; then
    sound_volume=$(( $(echo $sound_info | awk '{print $2}' | sed "s/[^0-9]//g") / 6))
    local str=""
    for (( i=0; i < 16; i++ )); do
      if (( $i < $sound_volume )) ; then
        str="${str}■"
      else
        str="${str} "
      fi
    done
    echo "[${str}]"
  else
    echo "[──────mute──────]"
  fi
fi
